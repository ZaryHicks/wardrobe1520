{% extends '_base.html' %}
{% block header %}
My Current Wardrobe
{% endblock %}
{% block content %}
<p>Click "Add Item" to add a new article of clothing to your Wardrobe<br>
   Click "Remove Item" to remove an article of clothing
</p>

<div>
    <!-- Add Item opens a modal window with a form for creating a clothing item -->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Add Item</button>

    <!-- Remove Item will remove all of the items that are checked in the table from the wardrobe -->
    <button type="button" class="btn btn-secondary" onclick="remClothes();">Remove Item</button>
</div>

<!-- Add item modal -->
<div class="Modal fade" id="myModal">
    <div class="modal-dialog" align="center">
        
        <!-- Modal Content -->
        <div class="modal-content" align="center">
            <div class="modal-body" align="center">
                <form class="form-main" id="addItemForm" method="post" action="/add" onsubmit="return addClothes();" align="center">
                    <!-- Title -->
                    <h2 class="text-center w-color-1" align="center">Add Item</h2>
                    
                    <!-- Clothing Type -->
                    <!-- is there a way to have the form change based on the type we select? - then the type doesnt need to be in the form and is just hardcoded -->
                    <div class="form-group">
                        <label class="w-color-1">Type</label>
                        <Select name="type" id="typesel" class="form-control" align="center">
                            <option name="type" value="Jacket">Jacket
                            <option name="type" value="Shirt">Shirt
                            <option name="type" value="Pants">Pants
                            <option name="type" value="Shoes">Shoes
                        </Select> 
                    </div>

                    <!-- div for shorts and short sleeves will get to later
                    <div class="form-group" id="shorts">
                        <label class="w-color-1">Are they shorts?</label>
                        <Select name="formal" class="form-control">
                            <option name="formal" value="False">Yes
                            <option name="formal" value="True">No
                        </Select> 
                    </div>-->

                    <!-- Item Name -->
                    <div class="form-group">
                        <label class="w-color-1">Name</label>
                        <input type="input" name="name" class="form-control" id="name" required>
                    </div>

                    <!-- Item Color -->
                    <div class="form-group">
                        <label class="w-color-1">Color</label>
                        <input type="color" name="color" class="form-control" id="color" required>
                    </div>

                    <!-- Item Casual Dropdown -->
                    <div class="form-group">
                        <label class="w-color-1">Is it casual?</label>
                        <Select name="casual" class="form-control" id="casual">
                            <option name="casual" value="True">Yes
                            <option name="casual" value="False">No
                        </Select> 
                    </div>

                    <!-- Item Max Temp -->
                    <div class="form-group">
                        <label class="w-color-1">High temperature</label>
                        <input type="number" name="high" class="form-control" id="high" required>
                    </div>

                    <!-- Item Min Temp -->
                    <div class="form-group">
                        <label class="w-color-1">Low temperature</label>
                        <input type="number" name="low" class="form-control" id="low" required>
                    </div>

                    <!-- Div for errors -->
                    <div id="validater"></div>

                    <!-- Submit Form -->
                    <div class="form-group">
                        <input type="submit" value="Submit" class="btn btn-primary w-bg-color-1">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- JS that clears the form in the add item modal when the modal is closed (on submission or otherwise) -->
<script>
$(document).ready(function(){
  $("#myModal").on('hidden.bs.modal', function(){
    $(this).find('form')[0].reset();
  });
});
</script>

<div class="container">
    <table id="table"
        data-checkbox-header="false"
        data-click-to-select="true"
        thead-classes="thead-light">
        <thead>
            <tr>
                <th data-field="state" data-checkbox="true">ID</th>
                <th data-field="type" data-sortable="true">Type</th>
                <th data-field="name" data-sortable="true">Name</th>
                <th data-field="color" data-sortable="true">Color</th>
                <th data-field="is_casual" data-sortable="true">Casual</th>
                <th data-field="high_temp" data-sortable="true">High</th>
                <th data-field="low_temp" data-sortable="true">Low</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
</div>

<script type=text/javascript>
    //define root to main
    $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    
    //*** IF we want to change how the data in the table looks, we can easily modify it in /get_wardrobe BEFORE we return it here
    //So formatting and some other things could be done on the data easily in python and then that could be sent up to the table

    //call this function when the page loads
    $(function() {
        //make a get request to /get_wardrobe, which returns JSON of the user's clothing items
        $.get($SCRIPT_ROOT + '/get_wardrobe', function(data) {
            //add their items to the table
            $('#table').bootstrapTable({data : JSON.parse(data)});
        });
        return false;
    });

</script>

<!--script>
  var $table = $('#table')

  $(function() {
    var data = [
      {
        'type': 'Jacket',
        'name': 'Denim',
        'color': 'Navy',
        'casual': 'Yes',
        'high': '75',
        'low': '50'
      },
      {
        'type': 'Jacket',
        'name': 'Winter Coat',
        'color': 'Gray',
        'casual': 'Yes',
        'high': '40',
        'low': '-10'
      },
      {
        'type': 'Pants',
        'name': 'AE Jeans',
        'color': 'Navy',
        'casual': 'Yes',
        'high': '65',
        'low': '50'
      },
      {
        'type': 'Pants',
        'name': 'Chinos',
        'color': 'Khaki',
        'casual': 'No',
        'high': '65',
        'low': '50'
      },
      {
        'type': 'Shoes',
        'name': 'Adidas Stan Smiths',
        'color': 'White',
        'casual': 'Yes',
        'high': '',
        'low': ''
      },
      {
        'type': 'Shirt',
        'name': 'T-Shirt',
        'color': 'Red',
        'casual': 'Yes',
        'high': '90',
        'low': '50'
      }
    ]
    $table.bootstrapTable({data: data})
  })
</script-->

<script>

//May not need all of this checking - since JS/Bootstrap has options to make field "required"
//need to determine what fields are needed based on the type, then we can check here that the correct fields are filled (and disable the unused ones?)
function addClothes(){
	//provides a form for the user to enter information on their clothing item
    //this will create a new clothing item that will be displayed in wardrobe and added to database
    var text = document.getElementById("validater");
    var typesel = document.getElementById("typesel").value;
    var name = document.getElementById("name").value;
    var color = document.getElementById("color").value;
    var casual = document.getElementById("casual").value;
    var high = document.getElementById("high").value;
    var low = document.getElementById("low").value;
    var items = document.getElementsByClassName("form-control");
    for(var i=0;i<items.length;i++){
		if(!(items[i]&&items[i].value)){
            text.innerHTML = "Please enter all fields";
            return false;
        }
	}
    if(parseInt(high)<low){
        text.innerHTML = "Please enter a higher temperature for your high temperature";
        return false;
    }
    
    //return true if there are no issues (this will submit)
    return true;
}

function remClothes(){
	//Selected item(s) will be removed from the user's wardrobe and also from the database
    
}

</script>
{% endblock %}