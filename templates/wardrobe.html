{% extends '_base.html' %}
{% block header %}
My Current Wardrobe
{% endblock %}
{% block content %}

<!-- Add item modal -->
<div class="Modal fade" id="myModal">
    <div class="modal-dialog" align="center">
        
        <!-- Modal Content -->
        <div class="modal-content" align="center">
            <div class="modal-body" align="center">
                <form class="form-main" id="addItemForm" method="post" action="/add" onsubmit="return addClothes();" align="center">
                    <!-- Title -->
                    <h2 class="text-center w-color-1" align="center">Add Item</h2>
                    
                    <!-- Clothing Type -->
                    <!-- is there a way to have the form change based on the type we select? - then the type doesnt need to be in the form and is just hardcoded -->
                    <div class="form-group">
                        <label class="w-color-1">Type</label>
                        <Select name="type" id="typesel" class="form-control" align="center">
                            <option name="type" value="Jacket">Jacket
                            <option name="type" value="Shirt">Shirt
                            <option name="type" value="Pants">Pants
                            <option name="type" value="Shoes">Shoes
                        </Select> 
                    </div>

                    <!-- Item Name -->
                    <div class="form-group">
                        <label class="w-color-1">Name</label>
                        <input type="input" name="name" class="form-control" id="name" required>
                    </div>

                    <!-- Item Color -->
                    <div class="form-group">
                        <label class="w-color-1">Color</label>
                        <input type="color" name="color" class="form-control" id="color" required>
                    </div>

                    <!-- Item Casual Dropdown -->
                    <div class="form-group">
                        <label class="w-color-1">Is it casual?</label>
                        <Select name="casual" class="form-control" id="casual">
                            <option name="casual" value="True">Yes
                            <option name="casual" value="False">No
                        </Select> 
                    </div>

                    <!-- Item Max Temp -->
                    <div class="form-group">
                        <label class="w-color-1">High temperature</label>
                        <input type="number" name="high" class="form-control" id="high" required>
                    </div>

                    <!-- Item Min Temp -->
                    <div class="form-group">
                        <label class="w-color-1">Low temperature</label>
                        <input type="number" name="low" class="form-control" id="low" required>
                    </div>

                    <!-- Custom tags -->
                    <!-- Css for the tags -->
                    <style>
                        .tag {
                            padding: 0.5em 0.75em;
                            margin: 0.25em 0.1em;
                            display: inline-block;
                            background-color: #ddd;
                            transition: all 0.1s linear;
                            cursor: pointer;
                        }

                        .tag2 {
                            padding: 0.5em 0.75em;
                            margin: 0.25em 0.1em;
                            display: inline-block;
                            background-color: #ddd;
                        }

                        .tag:hover {
                            background-color: #3af;
                            color: white;
                        }

                        .tag .close::after {
                            content: 'Ã—';
                            font-weight: bold;
                            display: inline-block;
                            transform: scale(1.4);
                            margin-left: 0.75em;
                        }

                        .tag .close:hover::after {
                            color: red;
                        }
                    </style>

                    <div class="tags-input" data-name="tags-input" id="tagdiv" class="form-group">
                        <label class="w-color-1">Tags (hit space to submit):</label>
                        <input type="hidden" name="tags-input" id="hid">
                        <input type="text" class="main-input form-control my-3" id="taginput">
                    </div>

                    <!-- script for the tags -->
                    <script>
                        function start(){
                            tags = [];
                            var space = document.getElementById('tagdiv');
                            var hid = document.getElementById('hid');
                            var inp = document.getElementById('taginput');

                            //adds the tag when user types space
                            inp.addEventListener('input',function(){
                                var entered = inp.value.split(' ');
                                if(entered.length > 1){
                                    entered.forEach(function(tag){
                                        if(tag.length>0){
                                            addTag(tag);
                                        }
                                    });
                                    inp.value = '';
                                }
                            });
                            
                            //deletes last tag when user presses backspace
                            inp.addEventListener('keydown',function(key){
                                var keyCode = key.which||key.keyCode;
                                if (keyCode===8&&inp.value.length===0&&tags.length>0) {
                                    removeTag(tags.length - 1);
                                }
                            });

                            //adds the tag
                            function addTag(text){
                                var tag = {
                                    text: text,
                                    element: document.createElement('span'),
                                };
                                tag.element.classList.add('tag');
                                tag.element.textContent = tag.text;
                                var close = document.createElement('span');
                                close.classList.add('close');
                                close.addEventListener('click', function(){
                                    removeTag(tags.indexOf(tag));
                                });
                                tag.element.appendChild(close);

                                tags.push(tag);
                                space.insertBefore(tag.element,inp);
                                refreshTags()
                            }

                            //removes tags
                            function removeTag(i){
                                var tag = tags[i];
                                tags.splice(i,1);
                                space.removeChild(tag.element);
                                refreshTags();
                            }

                            //refreshes tags
                            function refreshTags(){
                                let tagsList = [];
                                tags.forEach(function (t) {
                                    tagsList.push(t.text);
                                });
                                hid.value = tagsList.join(',');
                            }
                        }
                        start();
                    </script>

                    <!-- Div for errors -->
                    <div id="validater"></div>

                    <!-- Submit Form -->
                    <div class="form-group">
                        <input type="submit" value="Submit" class="btn btn-primary w-bg-color-1">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Edit item modal -->
<div class="Modal fade" id="editModal">
    <div class="modal-dialog" align="center">
        
        <!-- Modal Content -->
        <div class="modal-content" align="center">
            <div class="modal-body" align="center">
                <form class="form-main" id="editItemForm" method="post" action="/edit" onsubmit="return addClothes();" align="center">
                    <!-- Title -->
                    <h2 class="text-center w-color-1" align="center">Edit Item</h2>
                    
                    <input type="hidden" name="id" id="hiddenID">
                    <!-- Clothing Type -->
                    <!-- is there a way to have the form change based on the type we select? - then the type doesnt need to be in the form and is just hardcoded -->
                    <div class="form-group">
                        <label class="w-color-1">Type</label>
                        <Select name="type" id="etypesel" class="form-control" align="center">
                            <option name="type" value="Jacket">Jacket
                            <option name="type" value="Shirt">Shirt
                            <option name="type" value="Pants">Pants
                            <option name="type" value="Shoes">Shoes
                        </Select> 
                    </div>

                    <!-- Item Name -->
                    <div class="form-group">
                        <label class="w-color-1">Name</label>
                        <input type="input" name="name" class="form-control" id="ename" required>
                    </div>

                    <!-- Item Color -->
                    <div class="form-group">
                        <label class="w-color-1">Color</label>
                        <input type="color" name="color" class="form-control" id="ecolor" required>
                    </div>

                    <!-- Item Casual Dropdown -->
                    <div class="form-group">
                        <label class="w-color-1">Is it casual?</label>
                        <Select name="casual" class="form-control" id="ecasual">
                            <option name="casual" value="True">Yes
                            <option name="casual" value="False">No
                        </Select> 
                    </div>

                    <!-- Item Max Temp -->
                    <div class="form-group">
                        <label class="w-color-1">High temperature</label>
                        <input type="number" name="high" class="form-control" id="ehigh" required>
                    </div>

                    <!-- Item Min Temp -->
                    <div class="form-group">
                        <label class="w-color-1">Low temperature</label>
                        <input type="number" name="low" class="form-control" id="elow" required>
                    </div>

                    <!-- Custom tags -->
                    <!-- Css for the tags -->
                    <style>
                        .tag {
                            padding: 0.5em 0.75em;
                            margin: 0.25em 0.1em;
                            display: inline-block;
                            background-color: #ddd;
                            transition: all 0.1s linear;
                            cursor: pointer;
                        }

                        .tag2 {
                            padding: 0.5em 0.75em;
                            margin: 0.25em 0.1em;
                            display: inline-block;
                            background-color: #ddd;
                        }

                        .tag:hover {
                            background-color: #3af;
                            color: white;
                        }

                        .tag .close::after {
                            content: 'Ã—';
                            font-weight: bold;
                            display: inline-block;
                            transform: scale(1.4);
                            margin-left: 0.75em;
                        }

                        .tag .close:hover::after {
                            color: red;
                        }
                    </style>

                    <div class="tags-input" data-name="tags-input" id="etagdiv" class="form-group">
                        <label class="w-color-1">Tags (hit space to submit):</label>
                        <input type="hidden" name="tags-input" id="ehid">
                        <input type="text" class="main-input form-control my-3" id="etaginput">
                    </div>

                    <!-- script for the edit tags -->
                    <script>
                        function estart(){
                            tags = [];
                            var space = document.getElementById('etagdiv');
                            var hid = document.getElementById('ehid');
                            var inp = document.getElementById('etaginput');

                            //adds the tag when user types space
                            inp.addEventListener('input',function(){
                                var entered = inp.value.split(' ');
                                if(entered.length > 1){
                                    entered.forEach(function(tag){
                                        if(tag.length>0){
                                            eaddTag(tag);
                                        }
                                    });
                                    inp.value = '';
                                }
                            });
                            
                            //deletes last tag when user presses backspace
                            inp.addEventListener('keydown',function(key){
                                var keyCode = key.which||key.keyCode;
                                if (keyCode===8&&inp.value.length===0&&tags.length>0) {
                                    eremoveTag(tags.length - 1);
                                }
                            });

                            //adds the tag
                            function eaddTag(text){
                                var tag = {
                                    text: text,
                                    element: document.createElement('span'),
                                };
                                tag.element.classList.add('tag');
                                tag.element.textContent = tag.text;
                                var close = document.createElement('span');
                                close.classList.add('close');
                                close.addEventListener('click', function(){
                                    eremoveTag(tags.indexOf(tag));
                                });
                                tag.element.appendChild(close);

                                tags.push(tag);
                                space.insertBefore(tag.element,inp);
                                erefreshTags()
                            }

                            //removes tags
                            function eremoveTag(i){
                                var tag = tags[i];
                                tags.splice(i,1);
                                space.removeChild(tag.element);
                                erefreshTags();
                            }

                            //refreshes tags
                            function erefreshTags(){
                                let tagsList = [];
                                tags.forEach(function (t) {
                                    tagsList.push(t.text);
                                });
                                hid.value = tagsList.join(',');
                            }
                        }
                        estart();

                        function autoAdd(arr){
                            tags = [];
                            var space = document.getElementById('etagdiv');
                            var hid = document.getElementById('ehid');
                            var inp = document.getElementById('etaginput');

                            //adds the tag when user types space
                            inp.addEventListener('input',function(){
                                var entered = inp.value.split(' ');
                                if(entered.length > 1){
                                    entered.forEach(function(tag){
                                        if(tag.length>0){
                                            add(tag);
                                        }
                                    });
                                    inp.value = '';
                                }
                            });
                            
                            //deletes last tag when user presses backspace
                            inp.addEventListener('keydown',function(key){
                                var keyCode = key.which||key.keyCode;
                                if (keyCode===8&&inp.value.length===0&&tags.length>0) {
                                    rem(tags.length - 1);
                                }
                            });

                            //adds the tag
                            function add(text){
                                var tag = {
                                    text: text,
                                    element: document.createElement('span'),
                                };
                                tag.element.classList.add('tag');
                                tag.element.textContent = tag.text;
                                var close = document.createElement('span');
                                close.classList.add('close');
                                close.addEventListener('click', function(){
                                    rem(tags.indexOf(tag));
                                });
                                tag.element.appendChild(close);

                                tags.push(tag);
                                space.insertBefore(tag.element,inp);
                                ref()
                            }

                            //removes tags
                            function rem(i){
                                console.log("rem")
                                var tag = tags[i];
                                tags.splice(i,1);
                                space.removeChild(tag.element);
                                ref();
                            }

                            //refreshes tags
                            function ref(){
                                let tagsList = [];
                                tags.forEach(function (t) {
                                    tagsList.push(t.text);
                                });
                                hid.value = tagsList.join(',');
                            }

                            //execute
                            for(let s of arr){
                                if(s != "-" && s != ""){
                                    add(s);
                                }
                            }
                            $('#editModal').on('hide.bs.modal', function(){
                                // should go through and remove
                                let col = space.childNodes;
                                console.log(col)
                                for(let i = 0; i < col.length; i++){
                                    console.log(col[i].nodeName);
                                    if(col[i].nodeName == "SPAN"){
                                        console.log("removing")
                                        space.removeChild(col[i]);
                                    }
                                }
                                console.log(space.childNodes)
                            });

                        }
                    </script>

                    <!-- Div for errors -->
                    <div id="validater"></div>

                    <!-- Submit Form -->
                    <div class="form-group">
                        <input type="submit" value="Submit" class="btn btn-primary w-bg-color-1">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- JS that clears the form in the add and edit item modal when the modal is closed (on submission or otherwise) -->
<script>
$(document).ready(function(){
  $("#myModal").on('hidden.bs.modal', function(){
    $(this).find('form')[0].reset();
  });
  $("#editModal").on('hidden.bs.modal', function(){
    $(this).find('form')[0].reset();
  });
});
</script>

<!-- JS for edit modal -->
<script>
    function populateEdit(){
        $("#editModal").on('show.bs.modal', function(event){
                let modal = $(this);

                //get the values of this row
                let id = $(event.relatedTarget).closest('tr').find('td:eq( 1 )').html();
                let type = $(event.relatedTarget).closest('tr').find('td:eq( 2 )').html();
                let name = $(event.relatedTarget).closest('tr').find('td:eq( 3 )').html();
                let color = $(event.relatedTarget).closest('tr').find('td:eq( 4 )').html();
                let casual = $(event.relatedTarget).closest('tr').find('td:eq( 5 )').html();
                let high = $(event.relatedTarget).closest('tr').find('td:eq( 6 )').html();
                let low = $(event.relatedTarget).closest('tr').find('td:eq( 7 )').html();
                let tags = $(event.relatedTarget).closest('tr').find('td:eq( 8 )').html();
                console.log("Got " + type + " " + name + " " + color + " " + casual + " " + high + " " + low + " " + tags );

                //set modal values to matc
                modal.find('.modal-body #hiddenId').val(id)
                modal.find('.modal-body #etypesel').val(type)
                modal.find('.modal-body #ename').val(name)
                modal.find('.modal-body #ecolor').val(color)
                modal.find('.modal-body #ecasual').val(casual)
                modal.find('.modal-body #ehigh').val(high)
                modal.find('.modal-body #elow').val(low)

                let re1 = new RegExp('<span class="tag2">', 'g');
                let re2 = new RegExp('</span>', 'g');

                let finishedTags = tags.replace(re1, "").replace(re2, ",");
                let tArray = finishedTags.split(',');
                //modal.find('.modal-body #etaginput').val(tArray);
                autoAdd(tArray);
                
        });
    };

/*
$('#exampleModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
  var recipient = button.data('whatever') // Extract info from data-* attributes
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
  var modal = $(this)
  modal.find('.modal-title').text('New message to ' + recipient)
  modal.find('.modal-body input').val(recipient)
})
*/

</script>

<!-- JS that populates the table with the user's clothing items -->
<script type=text/javascript>
    //define root to main
    $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    
    //*** IF we want to change how the data in the table looks, we can easily modify it in /get_wardrobe BEFORE we return it here
    //So formatting and some other things could be done on the data easily in python and then that could be sent up to the table

    //call this function when the page loads
    $(function() {
        //make a get request to /get_wardrobe, which returns JSON of the user's clothing items
        $.get($SCRIPT_ROOT + '/get_wardrobe', function(data) {
            //add their items to the table
            //console.log(JSON.parse(data))
            $('#table').bootstrapTable({data : JSON.parse(data)});
        });
        
        return false;
    });
</script>

<div class="row vhm-60 m-0" >
    <div class="col-sm-3 w-bg-color-1 p-3 text-center flexbox">
        <h4>Wardrobe</h4>
        <div>
            <!-- Add Item opens a modal window with a form for creating a clothing item -->
            <button type="button" class="btn btn-primary my-3 w-70" data-toggle="modal" data-target="#myModal">Add Item</button>
            <!-- Remove Item will remove all of the items that are checked in the table from the wardrobe -->
            <button type="button" class="btn btn-secondary my-3 w-70" id="remover">Remove Item</button>
        </div>
    </div>
    <div class="col-sm-9 p-0">
        <div>
            <table id="table"
                data-checkbox-header="false"
                data-click-to-select="true"
                thead-classes="thead-light">
                <thead>
                    <tr>
                        <th data-field="state" data-checkbox="true" >Remove</th>
                        <th data-field="id" data-sortable="true">ID</th>
                        <th data-field="id5" data-sortable="true" data-visible="false">ID5</th>
                        <th data-field="type" data-sortable="true">Type</th>
                        <th data-field="name" data-sortable="true">Name</th>
                        <th data-field="color" data-sortable="true">Color</th>
                        <th data-field="is_casual" data-sortable="true">Casual</th>
                        <th data-field="high_temp" data-sortable="true">High</th>
                        <th data-field="low_temp" data-sortable="true">Low</th>
                        <th data-field="tags" data-sortable="true">Tags</th>
                        <th data-field="editRow" data-sortable="true">Edit Item</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>
            </table>
        </div>
    </div>
</div>


<!-- Recommendations Section (Bootsrap JS Carousel Part of Options) -->
<div class="row min-vh-100 m-0">
    <div class="form-generate col-sm-3 w-bg-color-1 p-0 flexbox">
        <form method="post" action="/generate" class="text-center p-3">
            <h4 class="py-3">Recommend</h4>
            <h6 class="m-0">Temperature (Â°F)</h6>
            <input type="text" id="temp-generate" name="temp" value="45" class="form-control text-center w-bg-color-1"> 
            <h6 class="m-0">Casual</h6>
            <select id="casual-generate" name="casual-generate" class="form-control w-bg-color-1">
                <option value="True">Yes</option>
                <option value="False">No</option>
            </select>
            <h6 class="m-0">Tags (separate with commas)</h6>
            <input type="text" id="genTags" name="tags" class="form-control text-center">
            <input type="submit" value="Generate" class="btn btn-primary mt-3">
        </form>
    </div>

    
    <div class="col-sm-9 showcase-background-welcome-blur">
        <div class="row align-items-center h-100 p-2">
            <div class= "col-sm-7">
                <div id="outfit-image-container">
                    <object class="outfit-image" type="image/svg+xml" data="/static/images/outfit.svg"></object>
                </div>
            </div>
            <div class="col-sm-5 text-center flexbox">
            <button class="btn my-3 btn-secondary" id="change-jacket">Change Jacket</button>
            <button class="btn my-3 btn-secondary" id="change-shirt">Change Shirt</button>
            <button class="btn my-3 btn-secondary" id="change-pants">Change Pants</button>
            <button class="btn my-3 btn-secondary" id="change-shoes">Change Shoes</button>

            <div id="outfit-text">
                <div class="notice">Generate outfits to see options here</div>
                <div class="jackets"></div>
                <div class="shirts"></div>
                <div class="pants"></div>
                <div class="shoes"></div>
                <div id="twitter-share-button-div"></div>
                <div id="email-share-button-div"></div>
                <a class="twitter-share-button-temp"
                    style="display:none;"
                    href="https://twitter.com/intent/tweet"
                    data-size="large"
                    data-text="custom share text"
                    data-url="https://dev.twitter.com/web/tweet-button">
                    Tweet
                </a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                <a id="email-share-button-temp" style="display:none;"><button type="button" class="btn btn-primary">Share by email</button></a>
            </div>
            </div>
        </div>
    </div>
</div>

<!-- Recommendations Section (table part of options) -->
<div class="container-fluid w-bg-color-1 all-combos-container overflow-auto">
    <h3 class=" text-center p-3">All Outfit Combinations</h3>
    <div id="all-combos"></div>
</div>

<script>
// get temp value for autofill in form
document.getElementById("temp-generate").value = localStorage.getItem('Temp').substring(0, localStorage.getItem('Temp').indexOf('Â°'));
// helper functions
function getTypes(type, array)
{
    var typeArr = []
    for(i = 0; i < array.length; i++)
    {
        if(array[i].type === type)
        {
            typeArr.push(array[i]);
        }
    }
    return typeArr;
}

function circleI(i, array)
{
    if(i+1 >= array.length)
        return 0;
    else
        return i+1;
}

function updateShare(jackets, indexJackets, shirts, indexShirts, pants, indexPants, shoes, indexShoes)
{
    var defaultText = 'Hey! My outfit of the day is \n'
    var hrefText = 'mailto:?Subject=Cool%20Outfit%20Generator&Body='
    var newText = defaultText;
    if(jackets.length > 0) { newText = newText+('Jacket: ' + jackets[indexJackets].name+"\n"); }
    if(shirts.length > 0) { newText = newText+('Shirt: ' + shirts[indexShirts].name+"\n"); }
    if(pants.length > 0) { newText = newText+('Pants: ' + pants[indexPants].name+"\n"); }
    if(shoes.length > 0) { newText = newText+('Shoes: ' + shoes[indexShoes].name+"\n"); }
    $('#twitter-share-button-div').empty()
    $('#email-share-button-div').empty()
    if(newText !== defaultText){    
        var eclone = $('#email-share-button-temp').clone();
        hrefText = hrefText+encodeURIComponent(newText);
        eclone.attr("href", hrefText); 
        eclone.removeAttr("style");
        $('#email-share-button-div').append(eclone);

        var tclone = $('.twitter-share-button-temp').clone();
        tclone.removeAttr("style");
        tclone.attr("data-text", newText);
        tclone.attr("data-url", "http://wardrobe-268517.appspot.com/"); 
        tclone.attr("class", "twitter-share-button"); 

        $('#twitter-share-button-div').append(tclone);
        twttr.widgets.load();
    }
}
// script to handle generate form
$('.form-generate form').submit(function(event){
    event.preventDefault();

    var casualGenerate = document.getElementById('casual-generate').value;
    var tempGenerate = document.getElementById('temp-generate').value;
    var tagGenerate = document.getElementById('genTags').value;
    $.ajax({
        type : "POST",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        url : "/generate?clothes=yes",
        data: JSON.stringify({
                  'casual-generate': casualGenerate,
                  'temp-generate': tempGenerate,
                  'tags': tagGenerate,
               }),
        success: function (response, status) {
            //console.log(status);
            var items = response;
            //console.log(response);

            //show buttons
            $("#change-jacket, #change-shirt, #change-pants, #change-shoes").css(
                "display", "block");

            //sort items in pile to arrays:
            var jackets = getTypes('Jacket', items);
            var indexJackets = 0;
            var shirts = getTypes('Shirt', items);
            var indexShirts = 0;
            var pants = getTypes('Pants', items);
            var indexPants = 0;
            var shoes = getTypes('Shoes', items);
            var indexShoes = 0;

            //show first outfit
            if(jackets.length > 0)
            {
                document.querySelector(".outfit-image").getSVGDocument().querySelector("#jacket path").style.fill = jackets[indexJackets].color;
            }
            if(shirts.length > 0)
            {
                document.querySelector(".outfit-image").getSVGDocument().querySelector("#t-shirt path").style.fill = shirts[indexShirts].color;
            }
            if(pants.length > 0)
            {
                document.querySelector(".outfit-image").getSVGDocument().querySelector("#pants path").style.fill = pants[indexPants].color;
            }
            if(shoes.length > 0)
            {
                document.querySelector(".outfit-image").getSVGDocument().querySelector("#shoes-color path").style.fill = shoes[indexShoes].color;
                document.querySelector(".outfit-image").getSVGDocument().querySelector("#shoes-color1 path").style.fill = shoes[indexShoes].color;
            }

            //TODO: clicks (same code, could be codensed)
            document.getElementById("change-jacket").addEventListener("click", function() {
                if(jackets.length > 0)
                {
                    indexJackets = circleI(indexJackets, jackets);
                    document.querySelector(".outfit-image").getSVGDocument().querySelector("#jacket path").style.fill = jackets[indexJackets].color;
                    $('.jackets').html('Jacket: ' + jackets[indexJackets].name + '<br>');
                    updateShare(jackets, indexJackets, shirts, indexShirts, pants, indexPants, shoes, indexShoes);
                }
            });
            document.getElementById("change-shirt").addEventListener("click", function() {
                if(shirts.length > 0)
                {
                    indexShirts = circleI(indexShirts, shirts);
                    document.querySelector(".outfit-image").getSVGDocument().querySelector("#t-shirt path").style.fill = shirts[indexShirts].color;
                    $('.shirts').html('Shirt: ' + shirts[indexShirts].name + '<br>');
                    updateShare(jackets, indexJackets, shirts, indexShirts, pants, indexPants, shoes, indexShoes);
                }
            });
            document.getElementById("change-pants").addEventListener("click", function() {
                if(pants.length > 0)
                {
                    indexPants = circleI(indexPants, pants);
                    document.querySelector(".outfit-image").getSVGDocument().querySelector("#pants path").style.fill = pants[indexPants].color;
                    $('.pants').html('Pants: ' + pants[indexPants].name + '<br>');
                    updateShare(jackets, indexJackets, shirts, indexShirts, pants, indexPants, shoes, indexShoes);
                }
            });
            document.getElementById("change-shoes").addEventListener("click", function() {
                if(shoes.length > 0)
                {
                    indexShoes = circleI(indexShoes, shoes);
                    document.querySelector(".outfit-image").getSVGDocument().querySelector("#shoes-color path").style.fill = shoes[indexShoes].color;
                    document.querySelector(".outfit-image").getSVGDocument().querySelector("#shoes-color1 path").style.fill = shoes[indexShoes].color;
                    $('.shoes').html('Shoes: ' + shoes[indexShoes].name + '<br>');
                    updateShare(jackets, indexJackets, shirts, indexShirts, pants, indexPants, shoes, indexShoes);
                }
            });

            // change instruction text to outfit
            $('.notice').html('');
            if(jackets.length > 0) { $('.jackets').html('Jacket: ' + jackets[indexJackets].name + '<br>');}
            if(shirts.length > 0) { $('.shirts').html('Shirt: ' + shirts[indexShirts].name + '<br>');}
            if(pants.length > 0) { $('.pants').html('Pants: ' + pants[indexPants].name + '<br>');}
            if(shoes.length > 0) { $('.shoes').html('Shoes: ' + shoes[indexShoes].name + '<br>');}
            updateShare(jackets, indexJackets, shirts, indexShirts, pants, indexPants, shoes, indexShoes);
        },
    });
    $.ajax({
        type : "POST",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        url : "/generate?clothes=no",
        data: JSON.stringify({
                  'casual-generate': casualGenerate,
                  'temp-generate': tempGenerate,
                  'tags': tagGenerate,
               }),
        success: function (data, status) {
            $('.all-combos-container').css('display', 'block');
            
            for(i = 0; i < data.length; i++)
            {
                var card = $('<div class="card m-3 p-3 float-left">');
                for(j = 0; j < data[i].length; j++)
                {
                    card.append( data[i][j].name + ' ' + data[i][j].type + '<br>');
                }
                card.append('</div>');
                $('#all-combos').append(card);
            }
            
        }
    });
});
</script>
<script>
//script to remove rows
  var $table = $('#table')
  var $button = $('#remover')

  $(function() {
    $button.click(function () {
        
        //finds which rows are checked
        var ids = $.map($table.bootstrapTable('getSelections'), function (row,$element) {
            return row
        })
        
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "/remove",
            data: JSON.stringify(ids),
            success: function (data) {
                console.log(data);
            },
            dataType: "json"
        });
        //ids the tables for removing
        $('#table').bootstrapTable('checkAll')
        var rows = $('#table').bootstrapTable('getSelections')
        $.each(rows,function(index,element){
            element.id5 = index
        })
        $('#table').bootstrapTable('uncheckAll')

        //gets the id of the table to remove
        var idss = []
        $.each(ids,function(index,element){
             idss.push(element.id5)
        }) 
        
        //removes the table
        $table.bootstrapTable('remove', {
        field: 'id5',
        values: idss
        })
    })
  })
</script>

<script>

//May not need all of this checking - since JS/Bootstrap has options to make field "required"
//need to determine what fields are needed based on the type, then we can check here that the correct fields are filled (and disable the unused ones?)
function addClothes(){
	//provides a form for the user to enter information on their clothing item
    //this will create a new clothing item that will be displayed in wardrobe and added to database
    var text = document.getElementById("validater");
    var typesel = document.getElementById("typesel").value;
    var name = document.getElementById("name").value;
    var color = document.getElementById("color").value;
    var casual = document.getElementById("casual").value;
    var high = document.getElementById("high").value;
    var low = document.getElementById("low").value;
    var items = document.getElementsByClassName("form-control");
    var tags = document.getElementById("hid").value;
    
    if(parseInt(high)<low){
        text.innerHTML = "Please enter a higher temperature for your high temperature";
        return false;
    }
    
    //return true if there are no issues (this will submit)
    return true;
}

//Selected item(s) will be removed from the user's wardrobe and also from the database

</script>
{% endblock %}